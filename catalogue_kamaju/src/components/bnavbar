import React, { useState, useEffect, useRef } from "react";
import { Link } from "react-router-dom";
import { FaBars, FaTimes } from "react-icons/fa";
import "./NavbarStyles.css";

const Navbar = () => {
  const [isMobileMenuActive, setIsMobileMenuActive] = useState(false);
  const [isSubmenuActive, setIsSubmenuActive] = useState(false);
  const menuRef = useRef(null);

  useEffect(() => {
    const handleClickOutside = (event) => {
      if (menuRef.current && !menuRef.current.contains(event.target)) {
        setIsMobileMenuActive(false);
        setIsSubmenuActive(false);
      }
    };

    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, []);

  const handleMobileMenuToggle = () => {
    setIsMobileMenuActive(!isMobileMenuActive);
    setIsSubmenuActive(false);
  };

  const handleSubmenuToggle = () => {
    setIsSubmenuActive(!isSubmenuActive);
  };

  return (
    <div className={`header ${isMobileMenuActive ? "header-mobile-active" : ""}`}>
      <Link to="/">
        <h1>Catalog</h1>
      </Link>
      <div className="menu-toggle" onClick={handleMobileMenuToggle}>
        {isMobileMenuActive ? <FaTimes size={20} style={{ color: "#fff" }} /> : <FaBars size={20} style={{ color: "#fff" }} />}
      </div>
      <ul className={`nav-menu ${isMobileMenuActive ? "mobile-active" : ""}`} ref={menuRef}>
        <li>
          <a href="/">Home</a>
        </li>
        <li className={`nav-item dropdown ${isSubmenuActive ? "active" : ""}`}>
          <div className="nav-link" onClick={handleSubmenuToggle}>
            Customer <i className={`fas fa-caret-${isSubmenuActive ? "up" : "down"}`}></i>
          </div>
          {isSubmenuActive && (
            <div className="dropdown-menu">
              <a href="/abb">Asmin Bara Bronang</a>
              <a href="/bjs">Bhumi Jepara Service</a>

              <a href="/bp">Bina Pertiwi</a>
              <a href="/bp-mo">Bina Pertiwi Mekanik Optional</a>
              <a href="/bp-hp">Bina Pertiwi Hopman</a>
              <a href="/bp-hs">Bina Pertiwi Hoseman</a>
              <a href="/bp-bat">Bina Pertiwi Operator BAT</a>
              <a href="/bp-p2g-p2u">Bina Pertiwi P2G P2U</a>
              <a href="/bp-it">Bina Pertiwi Inspector Tyreman</a>

              <a href="/bkm">Bintang Kalimantan Mandiri</a>
              <a href="/epn">Energia Prima Nusantara</a>

              <a href="/kpp-op">Kalimantan Prima Persada Operator</a>
              <a href="/kpp-wd">Kalimantan Prima Persada Welder</a>
              <a href="/kpp-mk">Kalimantan Prima Persada Mekanik</a>

              <a href="/kmsi">Komatsu Marketing and Support Indonesia</a>
              <a href="/kra">Komatsu Remanufacturing Asia</a>

              <a href="/pama-mr">Pamapersada Nusantara Mekanik Repairman</a>
              <a href="/pama-wd">Pamapersada Nusantara Welder</a>

              <a href="/ppa">Putra Perkasa Abadi</a>
              <a href="/smm">Suprabari Mapanindi Mineral</a>

              <a href="/shn-mh">Swadaya Harapan Nusantara Mekanik Helper</a>
              <a href="/shn-of">Swadaya Harapan Nusantara Operator Forklift</a>
              <a href="/shn-mg">Swadaya Harapan Nusantara Mekanik Genset</a>

              <a href="/top">Telen Orbit Prima</a>
              <a href="/tn-mh">Traktor Nusantara Mekanik Helper</a>
              <a href="/tn-yc">Traktor Nusantara Yard Crew</a>

              <a href="/tbp-mk">Triatra & Bina Pertiwi Mekanik</a>
              <a href="/tbp-ad">Triatra & Bina Pertiwi Admin</a>

              <a href="/ut-cs">United Tractors Cop Site</a>
              <a href="/ut-p2u">United Tractors P2U</a>
              <a href="/ut-mst">United Tractors Mekanik Site Tj. Enim</a>
              <a href="/ut-msb">United Tractors Mekanik Site Berau</a>
              <a href="/ut-mcs">United Tractors Mekanik Cabang & Site</a>
              <a href="/ut-pqa">United Tractors PPC & QA</a>
              <a href="/ut-ads">United Tractors Admin Site</a>
              <a href="/ut-ds">United Tractors Driver Site</a>
              <a href="/ut-os">United Tractors Operator Site</a>
              <a href="/ut-fo">United Tractors Facility Officer</a>
              <a href="/ut-wd">United Tractors Welder</a>
              <a href="/ut-mos">United Tractors Mekanik Optional Site</a>
              <a href="/ut-moc">United Tractors Mekanik Optional Cabang</a>
              <a href="/ut-yc">United Tractors Yard Crew</a>

              <a href="/utpe">United Tractors Pandu Engineering</a>
            </div>
          )}
        </li>
      </ul>
    </div>
  );
};

export default Navbar;
